# MFA Check & Steer — Detection Library Overview

The detection library is developed during Phase 4 to help SecOps analysts quickly identify risky MFA configurations and suspicious activity. This folder tracks detection design docs, rule specifications, and testing artifacts.

## Folder Structure
- `rules/` — Individual detection specifications (YAML/Markdown) describing logic, data sources, severity, and runbooks.
- `playbooks/` — Response guidance mapped to detections (will be filled in Phase 5).
- `tests/` — Sample inputs and expected detection outputs for automated validation.

## Conventions
- Every detection has an ID formatted as `MFA-DET-###`.
- Severity scale: `critical`, `high`, `medium`, `low`.
- Rules must document required data sources (e.g., canonical sign-ins, registration inventories).
- Where possible, detection logic should operate on normalized data generated by `Get-MfaEntraSignIn -Normalize` and `Get-MfaEntraRegistration -Normalize`.

Refer to `docs/detections/detection-strategy.md` for the overarching philosophy and acceptance criteria.

## Additional References
- `docs/detections/phase-4-suspicious-activity-scoring.md` documents the Phase 4.2 scoring model that correlates impossible travel, repeated failures, unusual devices, and MFA factor changes into a single prioritization score.
- `docs/detections/phase-4-framework-mapping.md` enumerates Phase 4.3 framework mappings and reporting tags that every detection output must include.
- `docs/detections/phase-4-incident-scenarios.md` defines the Phase 4.4 synthetic incident library, replay script expectations, and testing strategy.
- `docs/detections/phase-4-configuration.md` captures the Phase 4.5 configuration model, tuning guidance, and recommended guardrails for detection thresholds.
- `docs/detections/phase-4-controls-catalog.md` lists control objectives, owners, and SLAs introduced in Phase 4.6 to drive operational follow-through.
- `docs/detections/playbooks/phase-5-response-strategy.md` outlines the Phase 5 automation strategy and the MFA-PL-001 playbook delivered with this iteration.
- `docs/detections/playbooks/MFA-PL-001-reset-dormant-method.md`
- `docs/detections/playbooks/MFA-PL-002-contain-high-risk-signin.md`
- `docs/detections/playbooks/MFA-PL-003-enforce-privileged-role-mfa.md`
- `docs/detections/playbooks/MFA-PL-004-triage-suspicious-score.md`
