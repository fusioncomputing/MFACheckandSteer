{
  "ScenarioId": "INC-001",
  "Name": "MFA Fatigue Spray",
  "ReferenceTime": "2025-11-01T13:00:00Z",
  "Description": "Password spray leads to repeated MFA fatigue prompts for a privileged engineer; final risky success occurs from a new geography.",
  "SignIns": [
    {
      "RecordType": "SignIn",
      "Id": "inc1-signin-001",
      "TenantId": "00000000-0000-0000-0000-000000000000",
      "CreatedDateTime": "2025-11-01T12:00:00Z",
      "UserId": "22222222-2222-2222-2222-222222222222",
      "UserPrincipalName": "engineer@example.com",
      "UserDisplayName": "Privileged Engineer",
      "AppDisplayName": "Azure Portal",
      "AppId": "797f4846-ba00-4fd7-ba43-dac1f8f63013",
      "IpAddress": "198.51.100.25",
      "LocationCity": "Vancouver",
      "LocationState": "British Columbia",
      "LocationCountryOrRegion": "CA",
      "IsInteractive": true,
      "AuthenticationRequirement": "mfa",
      "AuthenticationRequirementPolicies": "Privileged-Access-MFA",
      "AuthenticationMethods": "password;notification",
      "ConditionalAccessStatus": "failure",
      "RiskDetail": "unfamiliarFeaturesOfThisDevice",
      "RiskLevelAggregated": "medium",
      "RiskState": "atRisk",
      "CorrelationId": "inc1-corr-001",
      "Result": "Failure",
      "ResultErrorCode": 500121,
      "ResultFailureReason": "User denied unexpected MFA prompt.",
      "ResultAdditionalDetails": "Push notification rejected."
    },
    {
      "RecordType": "SignIn",
      "Id": "inc1-signin-002",
      "TenantId": "00000000-0000-0000-0000-000000000000",
      "CreatedDateTime": "2025-11-01T12:05:00Z",
      "UserId": "22222222-2222-2222-2222-222222222222",
      "UserPrincipalName": "engineer@example.com",
      "UserDisplayName": "Privileged Engineer",
      "AppDisplayName": "Azure Portal",
      "AppId": "797f4846-ba00-4fd7-ba43-dac1f8f63013",
      "IpAddress": "198.51.100.25",
      "LocationCity": "Vancouver",
      "LocationState": "British Columbia",
      "LocationCountryOrRegion": "CA",
      "IsInteractive": true,
      "AuthenticationRequirement": "mfa",
      "AuthenticationRequirementPolicies": "Privileged-Access-MFA",
      "AuthenticationMethods": "password;notification",
      "ConditionalAccessStatus": "failure",
      "RiskDetail": "unfamiliarFeaturesOfThisDevice",
      "RiskLevelAggregated": "medium",
      "RiskState": "atRisk",
      "CorrelationId": "inc1-corr-002",
      "Result": "Failure",
      "ResultErrorCode": 500121,
      "ResultFailureReason": "Push denied by user.",
      "ResultAdditionalDetails": "Repeated unexpected prompt."
    },
    {
      "RecordType": "SignIn",
      "Id": "inc1-signin-003",
      "TenantId": "00000000-0000-0000-0000-000000000000",
      "CreatedDateTime": "2025-11-01T12:10:00Z",
      "UserId": "22222222-2222-2222-2222-222222222222",
      "UserPrincipalName": "engineer@example.com",
      "UserDisplayName": "Privileged Engineer",
      "AppDisplayName": "Azure Portal",
      "AppId": "797f4846-ba00-4fd7-ba43-dac1f8f63013",
      "IpAddress": "198.51.100.25",
      "LocationCity": "Vancouver",
      "LocationState": "British Columbia",
      "LocationCountryOrRegion": "CA",
      "IsInteractive": true,
      "AuthenticationRequirement": "mfa",
      "AuthenticationRequirementPolicies": "Privileged-Access-MFA",
      "AuthenticationMethods": "password;notification",
      "ConditionalAccessStatus": "failure",
      "RiskDetail": "unfamiliarFeaturesOfThisDevice",
      "RiskLevelAggregated": "medium",
      "RiskState": "atRisk",
      "CorrelationId": "inc1-corr-003",
      "Result": "Failure",
      "ResultErrorCode": 500121,
      "ResultFailureReason": "Timeout waiting for user confirmation.",
      "ResultAdditionalDetails": "Push ignored by user."
    },
    {
      "RecordType": "SignIn",
      "Id": "inc1-signin-004",
      "TenantId": "00000000-0000-0000-0000-000000000000",
      "CreatedDateTime": "2025-11-01T12:20:00Z",
      "UserId": "22222222-2222-2222-2222-222222222222",
      "UserPrincipalName": "engineer@example.com",
      "UserDisplayName": "Privileged Engineer",
      "AppDisplayName": "Azure Portal",
      "AppId": "797f4846-ba00-4fd7-ba43-dac1f8f63013",
      "IpAddress": "203.0.113.10",
      "LocationCity": "Seattle",
      "LocationState": "Washington",
      "LocationCountryOrRegion": "US",
      "IsInteractive": true,
      "AuthenticationRequirement": "mfa",
      "AuthenticationRequirementPolicies": "Privileged-Access-MFA",
      "AuthenticationMethods": "password;notification",
      "ConditionalAccessStatus": "success",
      "RiskDetail": "passwordSpray",
      "RiskLevelAggregated": "high",
      "RiskState": "atRisk",
      "CorrelationId": "inc1-corr-004",
      "Result": "Success",
      "ResultErrorCode": 0,
      "ResultFailureReason": null,
      "ResultAdditionalDetails": "User approved MFA after repeated prompts."
    }
  ],
  "Registrations": [
    {
      "RecordType": "Registration",
      "UserPrincipalName": "engineer@example.com",
      "UserId": "22222222-2222-2222-2222-222222222222",
      "MethodId": "fido2-key-01",
      "MethodType": "fido2AuthenticationMethod",
      "DisplayName": "Engineering YubiKey",
      "IsDefault": false,
      "IsUsable": true,
      "PhoneNumber": null,
      "PhoneType": null,
      "KeyDeviceId": "aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee",
      "CreatedDateTime": "2025-03-10T11:22:45Z",
      "LastUpdatedDateTime": "2025-05-09T18:11:12Z",
      "AdditionalData": {
        "aaguid": "08987058-cacd-4b81-b6e1-30de50dcbe96"
      }
    }
  ],
  "Expectations": {
    "Detections": [
      {
        "DetectionId": "MFA-DET-002",
        "UserPrincipalName": "engineer@example.com"
      }
    ],
    "Scores": [
      {
        "UserPrincipalName": "engineer@example.com",
        "Severity": "Critical",
        "MinScore": 75
      }
    ]
  }
}
